<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Notation · Glissa.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://adolgert.github.io/Glissa.jl/notation/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Glissa.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Notation</a><ul class="internal"><li><a class="tocitem" href="#Polynomial"><span>Polynomial</span></a></li><li><a class="tocitem" href="#Piecewise-Polynomial"><span>Piecewise Polynomial</span></a></li><li><a class="tocitem" href="#Polynomial-Spline"><span>Polynomial Spline</span></a></li><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li></ul></li><li><a class="tocitem" href="../bsplines/">B-splines</a></li><li><a class="tocitem" href="../testspaces/">Testing B-splines</a></li><li><a class="tocitem" href="../reference/">Reference</a></li><li><a class="tocitem" href="../projectplan/">Project Plan</a></li><li><a class="tocitem" href="../testplan/">Test Plan</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Notation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Notation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/adolgert/Glissa.jl/blob/master/docs/src/notation.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Notation"><a class="docs-heading-anchor" href="#Notation">Notation</a><a id="Notation-1"></a><a class="docs-heading-anchor-permalink" href="#Notation" title="Permalink"></a></h1><p>This defines terms in order to help read the code.</p><h2 id="Polynomial"><a class="docs-heading-anchor" href="#Polynomial">Polynomial</a><a id="Polynomial-1"></a><a class="docs-heading-anchor-permalink" href="#Polynomial" title="Permalink"></a></h2><p>A <strong>polynomial</strong> is a function of <span>$x$</span>, relative to some <span>$x_j$</span>, with constants <span>$c_i$</span>, of the form</p><p>p<em>j(x) = c</em>1 + c<em>2 (x - x</em>j) + c<em>3 (x - x</em>j)^2 = \sum<em>{i=1}^{i=d+1}c</em>i(x-x_j)^{i-1}$</p><p>The polynomial above has a <strong>degree</strong> of <span>$d=2$</span> because <span>$(x-x_1)^2$</span> is the largest power. It has <strong>order</strong> <span>$m=3$</span> because there are 3 constants <span>$(c_1, c_2, c_3)$</span>. In Julia, you can evaluate a polynomial with <a href="https://docs.julialang.org/en/v1/base/math/#Base.Math.evalpoly"><code>evalpoly</code></a>.</p><pre><code class="language-julia hljs">x = 5.5
x1 = 5.0
c = rand(3)
y = evalpoly(3, c)</code></pre><h2 id="Piecewise-Polynomial"><a class="docs-heading-anchor" href="#Piecewise-Polynomial">Piecewise Polynomial</a><a id="Piecewise-Polynomial-1"></a><a class="docs-heading-anchor-permalink" href="#Piecewise-Polynomial" title="Permalink"></a></h2><p>Separate the <span>$x$</span>-axis into <span>$(x_1, x_2, x_3, x_4... x_{k+2})$</span> so that there are <span>$k + 1$</span> intervals, where <strong>interval</strong> <span>$j$</span> is the axis between <span>$x_j$</span> and <span>$x_{j+1}$</span>, not including the endpoint <span>$x_{j+1}$</span>. Now define a polynomial on each interval. Each of these is a <strong>polynomial piece</strong>. The <span>$x_2\ldots x_{k+1}$</span>-values, which excludes the endpoints, are called <strong>knots.</strong></p><p>We need two indices on the constants, so they are now <span>$c_{ij}$</span>, where the row is the polynomial constant and the column is the polynomial piece. In addition, we assume all polynomial pieces have the same degree.</p><h2 id="Polynomial-Spline"><a class="docs-heading-anchor" href="#Polynomial-Spline">Polynomial Spline</a><a id="Polynomial-Spline-1"></a><a class="docs-heading-anchor-permalink" href="#Polynomial-Spline" title="Permalink"></a></h2><p>The piecewise polynomial above makes no guarantees that neighboring intervals will be continuous. If the value of the polynomial in one interval is continuous with the value of the neighboring polynomial, it&#39;s called <span>$C^0$</span> smooth. If, in addition to being continuous, the first derivatives match, then it&#39;s <span>$C^1$</span> smooth. For matching second derivatives, that&#39;s <span>$C^2$</span> smooth.</p><p>A <strong>polynomial spline with simple knots</strong> is a piecewise polynomial, of degree <span>$d$</span>, which is <span>$C^{d-1}$</span> smooth at each knot. It couldn&#39;t be any more smooth, because if we say, for instance, that two second-degree polynomials have the same values and derivatives, all the way up to second derivatives, then they are the same polynomial because they have to have the same polynomial constants.</p><p>A general <strong>polynomial spline</strong> guarantees that you don&#39;t have a situation where the derivatives agree across a knot, but the values aren&#39;t continuous. That may seem weird, but it&#39;s useful for some kinds of integration. Because of this restriction, we can think of each knot as having its own continuity condition. For instance, for a quadratic spline, each knot could be <span>$C^0$</span> or <span>$C^1$</span>. For a quadratic spline, each knot could be <span>$C^0$</span>, <span>$C^1$</span>, <span>$C^2$</span>, or <span>$C^3$</span>.</p><p>The <strong>multiplicity</strong> of a knot indicates its smoothness. For a degree <span>$d$</span> polynomial, a multiplicity <span>$m_j=1$</span> know has maximal smoothness, which is <span>$C^{d-1}$</span>. As multiplicity increases, smoothness across the knot decreases. The maximum multiplicity is <span>$m_j=m$</span>, where <span>$m=d+1$</span> is the order of the polynomial. When <span>$j_j=m$</span>, then the two neighboring polynomial pieces are disconnected. Note that endpoints aren&#39;t knots, just places where intervals meet. In code, an array <code>m[i]</code> is a multiplicity vector, but an integer <code>m</code> is the order.</p><p>There is another way to represent knot multiplicity. When listing the knots, repeat values for the knots of higher multiplicity, so <span>$(x_1, x_1, x_1, x_2, x_2, x_3, x_3 x_4, x_4, x_4)$</span>. Some algorithms rely on neighboring knots sometimes being equal.</p><p>There is some sense to using the word, multiplicity, to denote smoothness of splines. If three neighboring intervals are <span>$C^2$</span> smooth, and you drag the knots together, shrinking the middle interval, the resulting neighboring intervals will only be <span>$C^1$</span> smooth. Overlapping knots are equivalent to reduced continuity.</p><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><p>At the left-most <span>$x_1$</span> and the right-most <span>$x_{k+1}$</span>, we can define boundary conditions. A <strong>boundary condition</strong> is a specific value for the <span>$j$</span>-th derivative of the polynomial at that boundary. We will discuss so-called natural boundary conditions, meaning that we require the polynomial value to be 0 at the boundary, or its value and first derivative both to be 0, or its value and first two derivatives to be 0, and so on.</p><p>For a degree <span>$d=2$</span> polynomial, we can require the value to be zero and the first derivative to be zero. That&#39;s up to 2 boundary conditions. If we required more, it would set the polynomial to be zero within the interval neighboring the boundary.</p><p>A boundary condition at <span>$x_1$</span> or <span>$x_{k+1}$</span> is kind of like a continuity condition with some polynomial piece that&#39;s outside the axis of the polynomial spline. Because of this similarity, we can represent boundary conditions by 1) defining values for a neighboring polynomial on each side and 2) assigning a multiplicity to the endpoints the same way we assign multiplicity to the knots. In this case, a multiplicity of 1 means that, at the endpoint, the polynomial piece is <span>$C^{d-1}$</span> continuous with the polynomial outside. A multiplicity of <span>$d+1$</span> means there is no continuity, so there are no boundary conditions at that endpoint.</p><table><tr><th style="text-align: right">Degree</th><th style="text-align: right">Boundary Multiplicity</th><th style="text-align: right">Continuity with Zero</th></tr><tr><td style="text-align: right">2</td><td style="text-align: right">3</td><td style="text-align: right">not continuous</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">2</td><td style="text-align: right"><span>$C^0$</span> continuous</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">1</td><td style="text-align: right"><span>$C^1$</span>, once differentiable</td></tr><tr><td style="text-align: right">3</td><td style="text-align: right">4</td><td style="text-align: right">not continuous</td></tr><tr><td style="text-align: right">3</td><td style="text-align: right">3</td><td style="text-align: right"><span>$C^0$</span></td></tr><tr><td style="text-align: right">3</td><td style="text-align: right">2</td><td style="text-align: right"><span>$C^1$</span></td></tr><tr><td style="text-align: right">3</td><td style="text-align: right">1</td><td style="text-align: right"><span>$C^2$</span> twice differentiable</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../bsplines/">B-splines »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Sunday 2 October 2022 19:06">Sunday 2 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
